<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="web-app-capable" content="yes">
    <meta name="theme-color" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="description" content="A WebVR application framework.">
    <meta name="keywords" content="WebGL, WebVR, HTML5, JavaScript, text editor, source code editor, virtual reality, Primrose">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@Primrose_VR">
    <meta property="og:site_name" content="Primrose VR">
    <meta property="og:description" content="Primrose: Framework for WebVR Applications">
    <meta name="twitter:description" content="Primrose: Framework for WebVR Applications">
    <meta property="og:url" content="http://www.primrosevr.com/doc/jabbers.html"><!-- start main.jade meta block -->
    <meta name="twitter:image" content="http://www.primrosevr.com/images/screenshot.jpg">
    <meta property="og:image" content="http://www.primrosevr.com/images/screenshot.jpg"><!-- end main.jade meta block -->
<!-- start main.jade title block --><!-- start detailPage.jade title block -->
    <meta property="og:title" content="Primrose VR: WebVR Application Framework Documentation">
    <meta name="twitter:title" content="Primrose VR: WebVR Application Framework Documentation">
    <title>Primrose VR: WebVR Application Framework Documentation</title><!-- end detailPage.jade title block --><!-- end main.jade title block --><!-- start withFramework.jade head append -->
    <script type="text/javascript" src="../node_modules/logger/logger.js"></script>
    <script type="text/javascript" src="../node_modules/marked/marked.min.js"></script>
    <script type="text/javascript" src="../node_modules/pliny/pliny.js"></script>
    <script type="text/javascript" src="../node_modules/socket.io-client/socket.io.js"></script>
    <script type="text/javascript" src="../node_modules/jshashes/hashes.js"></script>
    <script type="text/javascript" src="../node_modules/three/three.js"></script>
    <script type="text/javascript" src="../node_modules/three/examples/js/loaders/OBJLoader.js"></script>
    <script type="text/javascript" src="../node_modules/three/examples/js/loaders/MTLLoader.js"></script>
    <script type="text/javascript" src="../node_modules/three/examples/js/loaders/FBXLoader.js"></script>
    <script type="text/javascript" src="../node_modules/html2canvas/dist/html2canvas.js"></script>
    <script type="text/javascript" src="../src/app.js"></script>
    <script type="text/javascript" src="../src/base/InsideSphereGeometry.js"></script>
    <script type="text/javascript" src="../src/base/axis.js"></script>
    <script type="text/javascript" src="../src/base/box.js"></script>
    <script type="text/javascript" src="../src/base/brick.js"></script>
    <script type="text/javascript" src="../src/base/cache.js"></script>
    <script type="text/javascript" src="../src/base/clone.js"></script>
    <script type="text/javascript" src="../src/base/cloud.js"></script>
    <script type="text/javascript" src="../src/base/copyObject.js"></script>
    <script type="text/javascript" src="../src/base/cylinder.js"></script>
    <script type="text/javascript" src="../src/base/emit.js"></script>
    <script type="text/javascript" src="../src/base/findProperty.js"></script>
    <script type="text/javascript" src="../src/base/fmt.js"></script>
    <script type="text/javascript" src="../src/base/forms.js"></script>
    <script type="text/javascript" src="../src/base/hub.js"></script>
    <script type="text/javascript" src="../src/base/light.js"></script>
    <script type="text/javascript" src="../src/base/patch.js"></script>
    <script type="text/javascript" src="../src/base/put.js"></script>
    <script type="text/javascript" src="../src/base/quad.js"></script>
    <script type="text/javascript" src="../src/base/range.js"></script>
    <script type="text/javascript" src="../src/base/shell.js"></script>
    <script type="text/javascript" src="../src/base/sphere.js"></script>
    <script type="text/javascript" src="../src/base/textured.js"></script>
    <script type="text/javascript" src="../src/base/v3.js"></script>
    <script type="text/javascript" src="../src/fx/Angle.js"></script>
    <script type="text/javascript" src="../src/fx/BaseControl.js"></script>
    <script type="text/javascript" src="../src/fx/BrowserEnvironment.js"></script>
    <script type="text/javascript" src="../src/fx/ButtonFactory.js"></script>
    <script type="text/javascript" src="../src/fx/DOM/StateList.js"></script>
    <script type="text/javascript" src="../src/fx/DOM/cascadeElement.js"></script>
    <script type="text/javascript" src="../src/fx/DOM/findEverything.js"></script>
    <script type="text/javascript" src="../src/fx/DOM/makeHidingContainer.js"></script>
    <script type="text/javascript" src="../src/fx/Entity.js"></script>
    <script type="text/javascript" src="../src/fx/HTTP/XHR.js"></script>
    <script type="text/javascript" src="../src/fx/HTTP/get.js"></script>
    <script type="text/javascript" src="../src/fx/HTTP/getBuffer.js"></script>
    <script type="text/javascript" src="../src/fx/HTTP/getObject.js"></script>
    <script type="text/javascript" src="../src/fx/HTTP/getText.js"></script>
    <script type="text/javascript" src="../src/fx/HTTP/post.js"></script>
    <script type="text/javascript" src="../src/fx/HTTP/sendObject.js"></script>
    <script type="text/javascript" src="../src/fx/IconManager.js"></script>
    <script type="text/javascript" src="../src/fx/InputProcessor.js"></script>
    <script type="text/javascript" src="../src/fx/Keys.js"></script>
    <script type="text/javascript" src="../src/fx/ModelLoader.js"></script>
    <script type="text/javascript" src="../src/fx/Pointer.js"></script>
    <script type="text/javascript" src="../src/fx/Projector.js"></script>
    <script type="text/javascript" src="../src/fx/Random/ID.js"></script>
    <script type="text/javascript" src="../src/fx/Random/color.js"></script>
    <script type="text/javascript" src="../src/fx/Random/int.js"></script>
    <script type="text/javascript" src="../src/fx/Random/item.js"></script>
    <script type="text/javascript" src="../src/fx/Random/number.js"></script>
    <script type="text/javascript" src="../src/fx/Random/steps.js"></script>
    <script type="text/javascript" src="../src/fx/RemoteUser.js"></script>
    <script type="text/javascript" src="../src/fx/Surface.js"></script>
    <script type="text/javascript" src="../src/fx/WebRTCSocket.js"></script>
    <script type="text/javascript" src="../src/fx/Workerize.js"></script>
    <script type="text/javascript" src="../src/fx/controls/ALabel.js"></script>
    <script type="text/javascript" src="../src/fx/controls/Button2D.js"></script>
    <script type="text/javascript" src="../src/fx/controls/Button3D.js"></script>
    <script type="text/javascript" src="../src/fx/controls/Form.js"></script>
    <script type="text/javascript" src="../src/fx/controls/HtmlDoc.js"></script>
    <script type="text/javascript" src="../src/fx/controls/Image.js"></script>
    <script type="text/javascript" src="../src/fx/controls/VUMeter.js"></script>
    <script type="text/javascript" src="../src/fx/input/FPSInput.js"></script>
    <script type="text/javascript" src="../src/fx/input/Gamepad.js"></script>
    <script type="text/javascript" src="../src/fx/input/Keyboard.js"></script>
    <script type="text/javascript" src="../src/fx/input/LeapMotion.js"></script>
    <script type="text/javascript" src="../src/fx/input/Location.js"></script>
    <script type="text/javascript" src="../src/fx/input/Media.js"></script>
    <script type="text/javascript" src="../src/fx/input/Motion.js"></script>
    <script type="text/javascript" src="../src/fx/input/Mouse.js"></script>
    <script type="text/javascript" src="../src/fx/input/Speech.js"></script>
    <script type="text/javascript" src="../src/fx/input/Touch.js"></script>
    <script type="text/javascript" src="../src/fx/input/VR.js"></script>
    <script type="text/javascript" src="../src/fx/network/AudioChannel.js"></script>
    <script type="text/javascript" src="../src/fx/network/DataChannel.js"></script>
    <script type="text/javascript" src="../src/fx/output/Audio3D.js"></script>
    <script type="text/javascript" src="../src/fx/output/HapticGlove.js"></script>
    <script type="text/javascript" src="../src/fx/output/Music.js"></script>
    <script type="text/javascript" src="../src/fx/output/Speech.js"></script>
    <script type="text/javascript" src="../src/fx/text/CodePage.js"></script>
    <script type="text/javascript" src="../src/fx/text/CommandPack.js"></script>
    <script type="text/javascript" src="../src/fx/text/Cursor.js"></script>
    <script type="text/javascript" src="../src/fx/text/Grammar.js"></script>
    <script type="text/javascript" src="../src/fx/text/OperatingSystem.js"></script>
    <script type="text/javascript" src="../src/fx/text/Point.js"></script>
    <script type="text/javascript" src="../src/fx/text/Rectangle.js"></script>
    <script type="text/javascript" src="../src/fx/text/Rule.js"></script>
    <script type="text/javascript" src="../src/fx/text/Size.js"></script>
    <script type="text/javascript" src="../src/fx/text/Terminal.js"></script>
    <script type="text/javascript" src="../src/fx/text/Token.js"></script>
    <script type="text/javascript" src="../src/fx/text/code_pages/DE_QWERTZ.js"></script>
    <script type="text/javascript" src="../src/fx/text/code_pages/EN_UKX.js"></script>
    <script type="text/javascript" src="../src/fx/text/code_pages/EN_US.js"></script>
    <script type="text/javascript" src="../src/fx/text/code_pages/FR_AZERTY.js"></script>
    <script type="text/javascript" src="../src/fx/text/command_packs/BasicTextInput.js"></script>
    <script type="text/javascript" src="../src/fx/text/command_packs/TextEditor.js"></script>
    <script type="text/javascript" src="../src/fx/text/command_packs/TextInput.js"></script>
    <script type="text/javascript" src="../src/fx/text/controls/PlainText.js"></script>
    <script type="text/javascript" src="../src/fx/text/controls/TextBox.js"></script>
    <script type="text/javascript" src="../src/fx/text/controls/TextInput.js"></script>
    <script type="text/javascript" src="../src/fx/text/grammars/Basic.js"></script>
    <script type="text/javascript" src="../src/fx/text/grammars/JavaScript.js"></script>
    <script type="text/javascript" src="../src/fx/text/grammars/PlainText.js"></script>
    <script type="text/javascript" src="../src/fx/text/grammars/TestResults.js"></script>
    <script type="text/javascript" src="../src/fx/text/operating_systems/OSX.js"></script>
    <script type="text/javascript" src="../src/fx/text/operating_systems/Windows.js"></script>
    <script type="text/javascript" src="../src/fx/text/themes/Dark.js"></script>
    <script type="text/javascript" src="../src/fx/text/themes/Default.js"></script>
    <script type="text/javascript" src="../src/three-ext/Object3D.prototype.addToBrowserEnvironment.js"></script>
    <script type="text/javascript" src="../src/x/LoginForm.js"></script>
    <script type="text/javascript" src="../src/x/SignupForm.js"></script><!-- end withFramework.jade head append --><!-- start detailPage.jade head append -->
    <link rel="stylesheet" type="text/css" href="style.css"><!-- end detailPage.jade head append --><!-- start documentation.jade head append --><!-- end documentation.jade head append -->
  </head>
  <body>
    <header role="banner"><a href="../">
        <h1>PrimroseVR</h1></a>
      <nav role="navigation">
        <ul>
          <li><a href="../doc/">Docs</a></li>
          <li><a href="../doc/faq.html">FAQ</a></li>
          <li><a href="../doc/community.html">Community</a></li>
          <li><a href="https://github.com/capnmidnight/Primrose/" target="_blank">Github</a></li>
        </ul>
      </nav>
      <h1>Documentation</h1>
    </header><!-- start main.jade banner block --><!-- end main.jade banner block -->
<!-- start main.jade main block -->
    <main><!-- start documentation.jade main block -->
      <div id="top"></div>
      <div id="contents">
        <nav>
          <ul>
            <li><a href="../doc/setup.html">Installation &amp; Setup</a></li>
          </ul>
        </nav>
      </div>
      <div id="documentation">
        <section>
          <article><!-- start documentation.jade documentation block --><!-- start demo.jade banner block -->
            <h1>Jabber Yabs</h1>
            <p>Click on the image below to lock mouse cursor to demo. <a href="../doc/jabbers" target="_blank">Open demo in new window</a>.</p>
            <iframe id="demo" src="../doc/jabbers" role="application" allowfullscreen></iframe>
            <h2>Source</h2>
            <pre id="editorContainer">grammar(&quot;JavaScript&quot;);
var WIDTH = 100,
  HEIGHT = 6,
  DEPTH = 100,
  MIDX = WIDTH / 2,
  MIDY = HEIGHT / 2,
  MIDZ = DEPTH / 2,
  t = 0,
  jabs = {},
  R = Primrose.Random,
  env = new Primrose.BrowserEnvironment(&quot;Jabber Yabs&quot;, {
    skyTexture: &quot;../images/bg2.jpg&quot;,
    groundTexture: &quot;../images/grass.png&quot;,
    fullScreenIcon: &quot;../models/monitor.obj&quot;,
    VRIcon: &quot;../models/cardboard.obj&quot;,
    font: &quot;../fonts/helvetiker_regular.typeface.js&quot;
  });

// and clicking on the objects in the scene
function makeJabJump(evt) {
  if (jabs[evt.objectID]) {
    jabs[evt.objectID].jump(evt.faceNormal);
  }
}
env.addEventListener(&quot;gazecomplete&quot;, makeJabJump);
env.addEventListener(&quot;pointerend&quot;, makeJabJump);

function eye(side, body) {
  var ball = put(textured(sphere(0.05, 6, 3), 0xffffff))
    .on(body)
    .at(side * 0.07, 0.05, 0.16)
    .obj();
  put(textured(sphere(0.01, 3, 2), 0))
    .on(ball)
    .at(0, 0, 0.045);
  return ball;
}

function Jabber(w, h, s) {
  var skin = R.item(Primrose.SKIN_VALUES),
    body = textured(sphere(0.2, 14, 7), skin),
    velocity = v3(
      R.number(-s, s),
      0,
      R.number(-s, s)),
    v = v3(0, 0, 0);

  body.position.set(
    R.number(-w, w),
    1,
    R.number(-h, h))

  eye(-1, body);
  eye(1, body);
  
  body.rotation.y = Math.PI;
  body.update = function (dt) {
    velocity.y -= env.options.gravity * dt;
    body.position.add(v.copy(velocity).multiplyScalar(dt));
    if (velocity.x &gt; 0 &amp;&amp; body.position.x &gt;= w ||
      velocity.x &lt; 0 &amp;&amp; body.position.x &lt;= -w) {
      velocity.x *= -1;
    }
    if (velocity.z &gt; 0 &amp;&amp; body.position.z &gt;= h ||
      velocity.z &lt; 0 &amp;&amp; body.position.z &lt;= -h) {
      velocity.z *= -1;
    }
    if (velocity.y &lt; 0 &amp;&amp; body.position.y &lt; 1) {
      velocity.y = 0;
      body.position.y = 1;
    }
    v.copy(body.position).sub(env.player.position);
    var d = v.length();
    if (d &lt; 3) {
      body.lookAt(env.player.position);
      body.position.set(
        R.number(-0.01, 0.01),
        R.number(-0.01, 0.01),
        R.number(-0.01, 0.01));
      v.divideScalar(d);
      v.y = 0;
      velocity.add(v.multiplyScalar((3 - d) / 100));
    }
    else {
      body.lookAt(v.copy(velocity).add(body.position));
    }
  };
  body.jump = function (normal) {
    v.fromArray(normal);
    v.y = env.options.gravity / 2;
    velocity.add(v);
  };
  return body;
}

// Once Primrose has setup the WebGL context, setup Three.js, 
// downloaded and validated all of model files, and constructed
// the basic scene hierarchy out of it, the &quot;ready&quot; event is fired,
// indicating that we may make additional changes to the scene now.
env.addEventListener(&quot;ready&quot;, function () {
  for (var i = 0; i &lt; 25; ++i) {
    var jab = Jabber(
      MIDX / 5,
      MIDZ / 5, 1);
    jabs[jab.uuid] = jab;
    env.appendChild(jab);
  }
});

env.addEventListener(&quot;update&quot;, function (dt) {
  for (var id in jabs) {
    jabs[id].update(dt);
  }
});</pre><!-- end documentation.jade documentation block -->
          </article>
        </section>
      </div><!-- end documentation.jade main block -->
    </main><!-- end main.jade main block -->
<!-- start main.jade footer block -->
    <footer>
      <div id="footerWrapper">
        <nav>
          <ul>
            <li><a href="../doc/about.html">About</a></li>
            <li><a href="../doc/#LICENSE.md">License</a></li>
            <li><a href="../doc/#CHANGELOG.md">Changelog</a></li>
            <li><a href="https://notiontheory.typeform.com/to/QzZmAD" target="_blank">Slack</a></li>
            <li><a href="http://www.notiontheory.com/team" target="_blank" style="color:#ec2471">Made (with love) by NotionTheory</a></li>
          </ul>
        </nav><a class="icon github" href="https://www.github.com/NotionTheory/Primrose" target="_blank">&nbsp;</a><a class="icon twitter" href="https://www.twitter.com/Primrose_VR" target="_blank">&nbsp;</a>
      </div>
      <script type="text/javascript" async defer src="app.js"></script>
    </footer><!-- end main.jade footer block -->
  </body>
</html>